<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Proof of Build</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Proof of Build is a Base-native collectible for early miniapp creators and supporters. Mint as many as you want, keep it as your onchain builder badge">
  <meta property="og:title" content="Proof of Build">
  <meta property="og:description" content="POB mint">
  <meta property="og:image" content="https://pob-lyart.vercel.app/og.png">
  <meta property="og:url" content="https://pob-lyart.vercel.app">
  <meta property="og:type" content="website">
  <meta name="fc:miniapp"
    content='{"version":"1","imageUrl":"https://pob-lyart.vercel.app/og.png","button":{"title":"Mint POB","action":{"type":"launch_miniapp","name":"Proof of Build","url":"https://pob-lyart.vercel.app","splashImageUrl":"https://pob-lyart.vercel.app/icon.png","splashBackgroundColor":"#0d1117"}}}' />
  <link rel="icon" type="image/png" href="https://pob-lyart.vercel.app/icon.png">
  <style>
    body{margin:0;background:#0a0f12;color:#dfe6eb;font-family:Inter,system-ui,sans-serif}
    .wrap{max-width:880px;margin:40px auto;padding:0 16px}
    .card{background:rgba(255,255,255,.02);border:1px solid rgba(255,255,255,.06);border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.5);overflow:hidden}
    .hero img{width:100%;display:block}
    .content{padding:22px}
    h1{margin:.3rem 0 1rem;font-size:28px;font-weight:700}
    .muted{color:#9fb0bb}
    .grid{display:grid;grid-template-columns:1fr auto;gap:12px;margin:10px 0}
    .btn{height:48px;border:0;border-radius:12px;font-weight:600;cursor:pointer}
    .btn-primary{background:linear-gradient(180deg,#53e6ff,#2baad2);color:#001317}
    .btn-primary:disabled{opacity:.6;cursor:not-allowed}
    .btn-outline{background:transparent;color:#dfe6eb;border:1px solid rgba(83,230,255,.4)}
    input{height:48px;border-radius:12px;background:#0b1216;border:1px solid rgba(255,255,255,.08);color:#dfe6eb;padding:0 14px;width:120px}
    .row{display:flex;gap:10px;margin:14px 0}
    .note{font-size:14px;color:#9fb0bb;margin-top:10px}
  </style>
</head>
<body>
<div class="wrap">
<div class="card">
  <div class="hero"><img src="/og.png"></div>
  <div class="content">
    <h1>Proof of Build</h1>
    <div class="muted">Chain: <b style="color:#cbe9f2">Base</b></div>
    <p class="muted">Mint your onchain builder badge and join the early Base miniapp creators.</p>
    <div class="grid">
      <div class="muted">Minted: <b id="minted">0</b></div>
      <div class="muted">Price: <b>0.0001 ETH</b></div>
    </div>
    <div class="grid">
      <div class="muted">You hold: <b id="youHold">0 POB</b></div>
      <div class="muted">Contract: <a id="addr" href="#" target="_blank" style="color:#53e6ff">view</a></div>
    </div>
    <div class="row">
      <input id="qty" type="number" min="1" value="1">
      <button class="btn btn-primary" id="mintBtn">Mint POB</button>
    </div>
    <div class="row"><button class="btn btn-outline" id="connectBtn">Connect wallet</button></div>
    <div class="note" id="acct">Wallet : not connected</div>
    <div class="note" id="status"></div>
  </div>
</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
<script>
(async()=>{
  const CONTRACT="0x01b91784C9B80d7fEfb206E2E1FC63ef1616386C";
  const TOKEN_ID=0, PRICE="0.0001";
  const BASECHAIN="0x2105", ZERO="0x0000000000000000000000000000000000000000";
  document.getElementById("addr").href="https://basescan.org/address/"+CONTRACT;
  const note=document.getElementById("status"), acct=document.getElementById("acct");
  const connectBtn=document.getElementById("connectBtn"), mintBtn=document.getElementById("mintBtn"), qty=document.getElementById("qty");
  const ABI=[{"inputs":[{"internalType":"address","name":"_receiver","type":"address"},{"internalType":"uint256","name":"_tokenId","type":"uint256"},{"internalType":"uint256","name":"_quantity","type":"uint256"},{"internalType":"address","name":"_currency","type":"address"},{"internalType":"uint256","name":"_pricePerToken","type":"uint256"},{"components":[{"internalType":"bytes32[]","name":"proof","type":"bytes32[]"},{"internalType":"uint256","name":"quantityLimitPerWallet","type":"uint256"},{"internalType":"uint256","name":"pricePerToken","type":"uint256"},{"internalType":"address","name":"currency","type":"address"}],"internalType":"struct IDrop1155.AllowlistProof","name":"_allowlistProof","type":"tuple"},{"internalType":"bytes","name":"_data","type":"bytes"}],"name":"claim","outputs":[],"stateMutability":"payable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_tokenId","type":"uint256"}],"name":"totalSupply","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"account","type":"address"},{"internalType":"uint256","name":"id","type":"uint256"}],"name":"balanceOf","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"}];

  let provider,signer,contract,account;
  async function ensureProvider(){
    if(!window.ethereum)throw"Wallet not found";
    provider=new ethers.providers.Web3Provider(window.ethereum,"any");
    await provider.send("eth_requestAccounts",[]);
    const net=await provider.getNetwork();
    if(net.chainId!==8453){
      await provider.send("wallet_switchEthereumChain",[{chainId:BASECHAIN}]);
    }
    signer=provider.getSigner();
    account=await signer.getAddress();
    contract=new ethers.Contract(CONTRACT,ABI,signer);
    acct.textContent="Wallet: "+account.slice(0,6)+"…"+account.slice(-4);
  }

  connectBtn.onclick=async()=>{note.textContent="";try{await ensureProvider();note.textContent="Wallet connected.";}catch(e){note.textContent=e.message||e}};
  mintBtn.onclick=async()=>{
    note.textContent="";
    try{
      await ensureProvider();
      const q=parseInt(qty.value)||1;
      const priceWei=ethers.utils.parseEther(PRICE);
      const total=priceWei.mul(q);
      const allowlist={proof:[],quantityLimitPerWallet:ethers.constants.MaxUint256,pricePerToken:priceWei,currency:ZERO};
      note.textContent="Waiting for wallet…";
      const tx=await contract.claim(account,TOKEN_ID,q,ZERO,priceWei,allowlist,"0x",{value:total});
      note.textContent="Tx sent → "+tx.hash.slice(0,10)+"…";
      await tx.wait();
      note.textContent="✅ Mint success";
    }catch(e){note.textContent=e.error?.message||e.data?.message||e.message||String(e);}
  };
})();
</script>
</body>
</html>
